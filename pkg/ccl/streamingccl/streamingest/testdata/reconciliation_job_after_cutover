# Tests that a fresh reconciliation job resumes after cutover

create-replication-clusters
----

start-replication-stream
----

let $start as=source-system
SELECT clock_timestamp()::timestamp::string
----

wait-until-replicated-time ts=$start
----

cutover ts=$start async
----

job as=destination-system wait-for-state=succeeded
----

start-replicated-tenant
----

exec-sql as=destination-system
ALTER TENANT ALL SET CLUSTER SETTING spanconfig.reconciliation_job.check_interval = '100ms'
----

query-sql as=destination-tenant retry
SELECT count(*) FROM [SHOW AUTOMATIC JOBS]
WHERE job_type = 'AUTO SPAN CONFIG RECONCILIATION' AND status = 'succeeded'
----
1

query-sql as=destination-tenant retry
SELECT count(*) FROM [SHOW AUTOMATIC JOBS]
WHERE job_type = 'AUTO SPAN CONFIG RECONCILIATION' AND status = 'running'
----
1
